---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Terminal from '../../components/Terminal.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
const sortedPosts = posts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Blog | Pasha Fateev">
  <Terminal path="~/blog" status={`POSTS ${sortedPosts.length}`}>
    <div class="output">
      <p><span class="prompt">pasha@portfolio:~/blog$</span> ls -la</p>
      <ul class="post-list">
        {sortedPosts.map((post) => (
          <li>
            <time datetime={post.data.pubDate.toISOString()}>
              {post.data.pubDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: '2-digit',
              })}
            </time>
            <a href={`/blog/${post.slug}`}>{post.data.title}</a>
          </li>
        ))}
      </ul>
      <p><span class="prompt">pasha@portfolio:~/blog$</span> cd ..</p>
      <p><a href="/">back to home</a><span class="cursor"></span></p>
    </div>
  </Terminal>
</BaseLayout>

<style>
  .output {
    display: grid;
    gap: 12px;
  }

  .output p {
    margin: 0;
  }

  .prompt {
    color: var(--term-green);
  }

  .post-list {
    margin: 0;
    padding: 0;
    list-style: none;
    display: grid;
    gap: 8px;
  }

  .post-list li {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }

  .post-list time {
    color: var(--term-dim);
    min-width: 112px;
  }
</style>
